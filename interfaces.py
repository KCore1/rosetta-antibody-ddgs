"""Finding interface residues and appending a 
column to the data telling whether interface 
residues are in the mutations.
Author: Karson Chrispens"""

import re
import numpy as np
import pandas as pd
data = pd.read_csv("./raw_datasets/use_this_data.csv")
# This is terribly messy but will have to do - 
# used pymol command interfaceResidues("#PDB", c1: antibody chain, c2: antigen chain, "selection name") 
# from script provided here: https://pymolwiki.org/index.php/InterfaceResidues

pdb_1BJ1 = ['T30', 'N31', 'Y32', 'G33', 'W47', 'W50', 'N52', 'T53', 'Y54', 'T55', 'E57', 'T59', 'Y99', 'P100', 'H101', 'Y102', 'Y103', 'G104', 'S105',
            'S106', 'H107', 'W108', 'F17', 'Y21', 'Y45', 'K48', 'Q79', 'I80', 'M81', 'R82', 'I83', 'K84', 'H86', 'Q87', 'G88', 'Q89', 'H90', 'I91', 'G92', 'E93', 'M94']
pdb_1NMB = ['Y52', 'G53', 'N54', 'G55', 'D56', 'T57', 'S58', 'Y99', 'R100', 'Y100A', 'D100B', 'I2', 'Q27', 'D28', 'S30', 'N31', 'Y32', 'Y50', 'D91', 'F92', 'T93',
            'L94', 'F96', 'P328', 'N329', 'D330', 'P331', 'T332', 'Y341', 'P342', 'G343', 'N344', 'I366', 'S367', 'I368', 'A369', 'S370', 'S372', 'N400', 'T401', 'W403', 'K432']
pdb_3BDY = ['Y33', 'R50', 'Y52', 'N54', 'W95', 'D98', 'G99', 'F100', 'Y100A', 'R27D', 'S28', 'I29', 'S30', 'G31', 'Y32', 'W50', 'Y53',
            'H91', 'Y92', 'T93', 'T94', 'Y45', 'K48', 'Q79', 'M81', 'R82', 'I83', 'K84', 'P85', 'H86', 'Q87', 'G88', 'Q89', 'H90', 'I91', 'G92', 'E93']
pdb_1C08 = ['Q27', 'S28', 'G30', 'N31', 'N32', 'K49', 'Y50', 'Q53', 'S91', 'N92', 'S93', 'W94', 'Y96', 'T30', 'S31', 'D32', 'Y33', 'Y50', 'S52', 'Y53', 'S54', 'S56', 'Y58', 'W98', 'D99',
            'D101', 'K13', 'R14', 'H15', 'G16', 'D18', 'N19', 'Y20', 'R21', 'W62', 'W63', 'R73', 'N74', 'L75', 'N77', 'T89', 'N93', 'K96', 'K97', 'V99', 'S100', 'D101', 'G102', 'N103', 'A107']
pdb_1VFB = ['H30', 'Y32', 'Y49', 'Y50', 'T52', 'T53', 'F91', 'W92', 'S93', 'R96', 'T30', 'G31', 'Y32', 'G33', 'W52', 'G53', 'D54', 'R99', 'D100', 'Y101', 'R102', 'K13',
            'D18', 'N19', 'R21', 'G22', 'Y23', 'S24', 'L25', 'G26', 'N27', 'G102', 'N103', 'K116', 'G117', 'T118', 'D119', 'V120', 'Q121', 'I124', 'R125', 'G126', 'C127', 'L129']
pdb_3BE1 = ['P557', 'E558', 'D560', 'Q561', 'K569', 'D570', 'P571', 'P572', 'F573', 'P579', 'I591', 'W592', 'K593', 'E598', 'A600', 'C601', 'Q602', 'P603', 'C604',
            'P605', 'Y33', 'R50', 'Y52', 'Y56', 'T57', 'R58', 'W95', 'G97', 'D98', 'G99', 'F100', 'Y100A', 'R27D', 'S28', 'G31', 'Y32', 'W50', 'Y53', 'H91', 'Y92', 'T93', 'T94']
pdb_1CZ8 = ['T30', 'H31', 'Y32', 'G33', 'W47', 'W50', 'N52', 'Y54', 'T55', 'T59', 'Y99', 'P100', 'Y101', 'Y102', 'Y103', 'G104', 'T105', 'S106', 'H107', 'W108', 'Y91', 'S92',
            'T93', 'V94', 'W96', 'V14', 'F17', 'Y21', 'Y39', 'Y45', 'K48', 'Q79', 'I80', 'M81', 'R82', 'I83', 'K84', 'P85', 'H86', 'Q87', 'G88', 'Q89', 'H90', 'I91', 'G92', 'E93', 'M94']
pdb_1XGP = ['S28', 'S30', 'N31', 'N32', 'K49', 'Y50', 'Q53', 'S91', 'N92', 'S93', 'W94', 'Y96', 'T30', 'S31', 'D32', 'A33', 'Y50', 'S52', 'Y53', 'S54', 'S56',
            'Y58', 'W98', 'G99', 'K13', 'R14', 'H15', 'G16', 'D18', 'N19', 'Y20', 'R21', 'W63', 'R73', 'N74', 'L75', 'T89', 'N93', 'K96', 'K97', 'V99', 'S100', 'D101', 'G102']
pdb_3BN9 = ['I41', 'C42', 'C42', 'H57', 'C58', 'C58', 'I60', 'D60A', 'D60B', 'R60C', 'G60D', 'F94', 'N95', 'D96', 'F97', 'T98', 'F99', 'H143', 'Y146', 'G147', 'L172', 'P173', 'Q174', 'Q175', 'S190', 'C191', 'Q192', 'S195', 'V213', 'S214', 'W215', 'G216', 'D217', 'G219',
            'C220', 'Q221A', 'K224', 'S30', 'Y32', 'G92', 'N93', 'L94', 'Y96', 'F27', 'T28', 'F29', 'S30', 'S31', 'A33', 'A50', 'I51', 'S52', 'G52A', 'S53', 'G55', 'S56', 'Y58', 'N73', 'N76', 'T98', 'Y99', 'P100', 'Q100A', 'R100B', 'R100C', 'G100D', 'P100E', 'Q100F', 'N100G', 'V100H']
pdb_1DQJ = ['S28', 'S30', 'N31', 'N32', 'K49', 'Y50', 'Q53', 'S67', 'S67', 'S91', 'N92', 'S93', 'W94', 'Y96', 'D27', 'T30', 'S31', 'D32', 'Y33', 'Y50', 'S52', 'Y53', 'S54', 'S56', 'Y58', 'W98',
            'G99', 'D101', 'D101', 'K13', 'R14', 'H15', 'G16', 'D18', 'N19', 'Y20', 'R21', 'W62', 'W63', 'R73', 'L75', 'N77', 'T89', 'N93', 'K96', 'K97', 'V99', 'S100', 'D101', 'G102', 'N103', 'A107']
pdb_1XGQ = ['S28', 'S30', 'N31', 'N32', 'K49', 'Y50', 'Q53', 'S91', 'N92', 'S93', 'W94', 'Y96', 'D27', 'T30', 'S31', 'D32', 'V33', 'Y50', 'S52', 'Y53', 'S54', 'S56', 'Y58', 'W98',
            'G99', 'K13', 'R14', 'H15', 'G16', 'D18', 'N19', 'Y20', 'R21', 'W62', 'W63', 'R73', 'L75', 'N77', 'T89', 'N93', 'K96', 'K97', 'I98', 'S100', 'D101', 'G102', 'N103', 'A107']
pdb_3G6D = ['V4', 'P5', 'P6', 'R11', 'I14', 'E15', 'V18', 'N19', 'T21', 'Q22', 'N23', 'Q24', 'K25', 'K97', 'L100', 'L101', 'K104', 'K105', 'F107', 'R108', 'E109', 'T28', 'S31', 'Y32',
            'Y53', 'L100', 'G101', 'A102', 'F103', 'H104', 'W105', 'D106', 'Q108', 'Y2', 'D25', 'N26', 'G28', 'G29', 'T30', 'F31', 'Y48', 'D49', 'D50', 'D52', 'N65', 'W90', 'D91', 'M92', 'V93']
pdb_1DVF = ['H30', 'Y32', 'Y49', 'Y50', 'T53', 'D56', 'F91', 'W92', 'S93', 'T94', 'R96', 'T30', 'G31', 'Y32', 'G33', 'W52', 'G53', 'D54', 'N56', 'T57', 'D58', 'E98', 'R99', 'D100', 'Y101',
            'R102', 'Y32', 'Y49', 'Y50', 'R53', 'N92', 'T93', 'L94', 'W96', 'K30', 'D31', 'H33', 'R50', 'D52', 'A53', 'N54', 'N56', 'Q58', 'K95', 'V96', 'I97', 'Y98', 'Y99', 'Q100', 'G100A', 'R100B']
pdb_1XGR = ['S28', 'S30', 'N31', 'N32', 'K49', 'Y50', 'Q53', 'S91', 'N92', 'S93', 'W94', 'Y96', 'T30', 'S31', 'D32', 'I33', 'Y50', 'S52', 'Y53', 'S54', 'S56', 'Y58', 'W98', 'G99',
            'D101', 'K13', 'R14', 'H15', 'G16', 'D18', 'N19', 'Y20', 'R21', 'W62', 'W63', 'R73', 'N74', 'L75', 'N77', 'T89', 'N93', 'K96', 'K97', 'V99', 'S100', 'D101', 'G102', 'N103']
pdb_3GBN = ['H18', 'H38', 'V40', 'N41', 'L42', 'S291', 'L292', 'P293', 'T318', 'G319', 'I18', 'D19', 'G20', 'W21', 'A36', 'Q38', 'T41', 'Q42', 'I45', 'D46',
            'I48', 'T49', 'V52', 'N53', 'I56', 'G27', 'P28', 'F29', 'R30', 'S31', 'P52A', 'I53', 'F54', 'T56', 'D72', 'F74', 'A75', 'M96', 'G97', 'Y98', 'Q99', 'R100A']
pdb_1JRH = ['Y32', 'G33', 'W52', 'W53', 'D54', 'D56', 'Y58', 'Y59', 'P61', 'R95', 'Y99', 'G100', 'H100B', 'K47', 'Y49', 'G50', 'V51', 'K52', 'N53',
            'S54', 'E55', 'W56', 'D76', 'S78', 'S80', 'W82', 'R84', 'K98', 'S99', 'V2', 'E27', 'D28', 'Y30', 'R32', 'K69', 'Y91', 'W92', 'S93', 'T94', 'W96']
pdb_1XGT = ['S28', 'S30', 'N31', 'N32', 'K49', 'Y50', 'Q53', 'S67', 'S91', 'N92', 'S93', 'W94', 'Y96', 'T30', 'S31', 'D32', 'L33', 'Y50', 'S52', 'Y53', 'S54', 'S56', 'Y58', 'W98', 'G99',
            'D101', 'K13', 'R14', 'H15', 'G16', 'D18', 'N19', 'Y20', 'R21', 'W62', 'W63', 'R73', 'N74', 'L75', 'N77', 'T89', 'N93', 'K96', 'K97', 'I98', 'V99', 'S100', 'D101', 'G102', 'N103']
pdb_3HFM = ['T30', 'S31', 'D32', 'Y33', 'Y50', 'S52', 'Y53', 'S54', 'S56', 'Y58', 'W98', 'G30', 'N31', 'N32', 'K49', 'Y50', 'Q53', 'S67', 'S91', 'N92', 'S93', 'W94', 'Y96',
            'K13', 'R14', 'H15', 'G16', 'D18', 'N19', 'Y20', 'R21', 'W62', 'W63', 'R73', 'L75', 'N77', 'T89', 'N93', 'K96', 'K97', 'I98', 'V99', 'S100', 'D101', 'G102', 'N103', 'A107']
pdb_1KIP = ['H30', 'Y32', 'Y49', 'Y50', 'T53', 'F91', 'W92', 'S93', 'R96', 'T30', 'G31', 'A32', 'G33', 'W52', 'G53', 'D54', 'R99', 'D100', 'Y101', 'R102',
            'D18', 'N19', 'G22', 'Y23', 'S24', 'L25', 'G26', 'N27', 'G102', 'N103', 'K116', 'G117', 'T118', 'D119', 'V120', 'Q121', 'I124', 'R125', 'G126', 'C127']
pdb_1XGU = ['S28', 'S30', 'N31', 'N32', 'K49', 'Y50', 'Q53', 'S67', 'S91', 'N92', 'S93', 'W94', 'Y96', 'T30', 'S31', 'D32', 'F33', 'Y50', 'S52', 'Y53', 'S54', 'S56', 'Y58', 'W98',
            'G99', 'K13', 'R14', 'H15', 'G16', 'D18', 'N19', 'Y20', 'R21', 'W62', 'W63', 'S72', 'R73', 'L75', 'N77', 'T89', 'N93', 'K96', 'K97', 'V99', 'S100', 'D101', 'G102', 'N103', 'A107']
pdb_3L5X = ['R11', 'I14', 'E15', 'V18', 'L101', 'K104', 'K105', 'F107', 'R108', 'E109', 'G110', 'Y32',
            'W54', 'W55', 'D56', 'V58', 'K59', 'R60', 'D103', 'Y104', 'D105', 'K31', 'Y32', 'H91', 'N92', 'Y96']
pdb_1KIQ = ['H30', 'Y32', 'Y49', 'Y50', 'T53', 'F91', 'W92', 'S93', 'T30', 'G31', 'Y32', 'G33', 'W52', 'G53', 'D54', 'R99', 'D100', 'F101', 'R102', 'K13',
            'D18', 'N19', 'G22', 'Y23', 'S24', 'G26', 'N27', 'G102', 'N103', 'K116', 'G117', 'T118', 'D119', 'V120', 'Q121', 'I124', 'R125', 'G126', 'C127', 'L129']
pdb_1YY9 = ['P349', 'R353', 'L382', 'Q384', 'Q408', 'H409', 'Q411', 'F412', 'A415', 'V417', 'S418', 'I438', 'S440', 'G441', 'K443', 'N449', 'K465', 'I466', 'I467', 'S468', 'N469', 'R470', 'G471',
            'E472', 'N473', 'Q27', 'S28', 'N32', 'K49', 'Y50', 'N91', 'N92', 'N93', 'W94', 'T96', 'N31', 'W52', 'S53', 'G54', 'G55', 'N56', 'T57', 'D58', 'Y59', 'T100', 'Y101', 'Y102', 'D103', 'Y104', 'E105']
pdb_3N85 = ['Q371', 'P372', 'E373', 'Q376', 'E379', 'D395', 'S396', 'L397', 'P398', 'D399', 'S401', 'V402', 'Q404', 'G427', 'S429', 'W430', 'R434', 'T450', 'H451', 'R477', 'P478', 'D480', 'E481', 'V483', 'G484', 'E485', 'G486', 'L487',
            'P501', 'G502', 'T504', 'Q505', 'G26', 'F27', 'S28', 'W30', 'W30', 'W31', 'S32', 'W33', 'S52', 'S53', 'S54', 'G55', 'W56', 'S58', 'Y59', 'D61', 'K64', 'T73', 'R94', 'W95', 'W96', 'S97', 'S98', 'A32', 'S50', 'W91', 'W92', 'W93', 'W94', 'P95']
pdb_1KIR = ['H30', 'Y32', 'Y49', 'S50', 'T53', 'F91', 'W92', 'S93', 'R96', 'T30', 'G31', 'Y32', 'G33', 'W52', 'G53', 'D54', 'R99', 'D100', 'Y101', 'R102',
            'D18', 'N19', 'G22', 'Y23', 'S24', 'L25', 'G26', 'N27', 'G102', 'N103', 'W111', 'K116', 'G117', 'T118', 'D119', 'V120', 'Q121', 'I124', 'R125', 'G126', 'L129']
pdb_2B2X = ['S156', 'N157', 'S158', 'I159', 'Y160', 'P161', 'E192', 'Q218', 'R219', 'G220', 'G221', 'R222', 'Q223', 'T224', 'M225', 'E259', 'S260', 'H261', 'N263', 'Y264', 'H288', 'Y289', 'L294', 'S295',
            'K298', 'L322', 'S30', 'R31', 'T33', 'W47', 'V50', 'S52', 'G53', 'G54', 'H56', 'Y58', 'Y59', 'F99', 'G100', 'D101', 'G103', 'Q28', 'V29', 'N30', 'H31', 'Y48', 'L49', 'Y52', 'W90', 'S91', 'N93', 'P94', 'W95']
pdb_3NGB = ['K97', 'G124', 'G198', 'N276', 'T278', 'N279', 'N280', 'A281', 'K282', 'T283', 'S365', 'G366', 'G367', 'D368', 'I371', 'W427', 'Q428', 'G429', 'T430', 'T455', 'R456', 'D457', 'G458', 'G459', 'A460', 'N461', 'T463', 'N465', 'E466', 'T467',
            'R469', 'G472', 'G473', 'N474', 'I30', 'T33', 'W47', 'W50', 'K52', 'R53', 'G54', 'G55', 'A56', 'V57', 'N58', 'Y59', 'A60', 'R61', 'P62', 'Q64', 'M69', 'R71', 'V73', 'Y74', 'D99', 'Y100', 'N100A', 'W100B', 'V3', 'Q27', 'Y28', 'Y91', 'E96', 'F97']
pdb_1MHP = ['S156', 'N157', 'S158', 'Y160', 'E192', 'Q218', 'R219', 'G220', 'G221', 'R222', 'Q223', 'T224', 'M225', 'E259', 'S260', 'H261', 'N263', 'Y264', 'K298', 'D320', 'S30', 'R31',
            'T33', 'W47', 'T50', 'S52', 'G53', 'G54', 'H56', 'Y58', 'Y59', 'N73', 'G100', 'D101', 'G103', 'S28', 'V29', 'N30', 'H31', 'L49', 'S66', 'G67', 'W90', 'S91', 'N93', 'P94', 'W95']
pdb_2BDN = ['Y28', 'R30', 'I31', 'T32', 'S33', 'S34', 'K35', 'P37', 'K38', 'E39', 'A40', 'V41', 'P55', 'K56', 'Q61', 'M64', 'D65', 'D68', 'K69', 'E1', 'V2', 'G26', 'N28',
            'K30', 'D31', 'T32', 'Y33', 'D52', 'A54', 'R98', 'G99', 'V100', 'F101', 'F103', 'D105', 'Y106', 'Y30', 'N31', 'R32', 'S49', 'G50', 'S53', 'E55', 'T56', 'F91', 'W92']
pdb_3SE8 = ['K97', 'T123', 'G124', 'G198', 'S199', 'T257', 'N276', 'T278', 'N279', 'N280', 'A281', 'K282', 'T283', 'K357', 'S365', 'G366', 'G367', 'D368', 'E370', 'I371', 'N425', 'M426', 'W427', 'G429', 'T430', 'G431', 'T455', 'R456', 'D457', 'G458', 'G459', 'A460', 'N461', 'N462', 'T463', 'N465', 'E466',
            'T467', 'R469', 'G472', 'G473', 'N474', 'I475', 'R30', 'S33', 'H35', 'E46', 'W47', 'W50', 'K52', 'L53', 'W54', 'G55', 'A56', 'V57', 'S58', 'Y59', 'A60', 'R61', 'Q62', 'Q64', 'R71', 'S74', 'Q75', 'D76', 'P76A', 'P76D', 'D99', 'Y100', 'G100B', 'D100C', 'F100D', 'E1', 'I2', 'Q27', 'N31', 'F91', 'E96', 'F97']
pdb_1MLC = ['N32', 'Y50', 'S91', 'N92', 'S93', 'W94', 'R96', 'S30', 'T31', 'Y32', 'W33', 'E35', 'E50', 'L52', 'S55', 'G56', 'S57', 'T58', 'Y59', 'G99',
            'D100', 'G101', 'Q41', 'T43', 'R45', 'N46', 'T47', 'D48', 'G49', 'S50', 'T51', 'Y53', 'N65', 'D66', 'G67', 'R68', 'T69', 'P70', 'P79', 'S81', 'L84']
pdb_2NY7 = ['S257', 'N280', 'A281', 'S364', 'S365', 'G366', 'G367', 'D368', 'P369', 'E370', 'I371', 'V372', 'T373', 'W375', 'Y384', 'N386', 'P417', 'R419', 'V430', 'G431', 'K432', 'T455', 'R456', 'D457', 'R469', 'G472',
            'G473', 'D474', 'M475', 'R28', 'S30', 'N31', 'F32', 'V33', 'W50', 'N52', 'P52A', 'Y53', 'N54', 'N56', 'K57', 'E58', 'T73', 'S74', 'N76', 'V95', 'P97', 'Y98', 'W100', 'D100B', 'P100D', 'Q100E', 'N100G', 'Y100H']
pdb_4FQY = ['H18', 'N38', 'T40', 'E41', 'L42', 'D291', 'K292', 'P293', 'T318', 'I18', 'D19', 'G20', 'W21', 'A36', 'L38', 'L38', 'T41', 'Q42', 'I45', 'D46', 'I48', 'I48',
            'N49', 'L52', 'N53', 'I56', 'T28', 'N30', 'N31', 'Y32', 'S52', 'P52A', 'I53', 'F54', 'G55', 'D72', 'I73', 'F74', 'N76', 'N97', 'Y98', 'Y99', 'Y100A', 'S100B', 'R31']
pdb_1N8Z = ['D28', 'N30', 'T31', 'A32', 'Y49', 'S50', 'F53', 'R66', 'H91', 'Y92', 'T93', 'T94', 'Y33', 'R50', 'Y52', 'Y57', 'T58', 'R59', 'W99', 'G101', 'D102', 'G103', 'F104',
            'Y105', 'P557', 'E558', 'D560', 'Q561', 'K569', 'D570', 'P571', 'P572', 'F573', 'V575', 'P579', 'I591', 'K593', 'D596', 'E598', 'A600', 'C601', 'Q602', 'P603', 'C604', 'P605']
pdb_2NYY = ['S902', 'K903', 'F917', 'N918', 'L919', 'E920', 'S921', 'P950', 'F953', 'N954', 'S955', 'I956', 'K1056', 'L1057', 'D1058', 'G1059', 'C1060', 'R1061', 'D1062', 'T1063', 'H1064', 'R1065', 'Y1066', 'T1145', 'D1289', 'G1290',
            'G1292', 'E1293', 'R1294', 'E27', 'S28', 'D30', 'S31', 'Y32', 'G33', 'H34', 'S35', 'F36', 'G70', 'S71', 'G95', 'N96', 'E97', 'V98', 'F100', 'Y31', 'Y33', 'Y35', 'S52', 'D53', 'G54', 'S56', 'Y57', 'T58', 'Y59', 'Y99', 'Y101', 'D102']
pdb_5C6T = ['D275', 'Y280', 'G282', 'T283', 'R285', 'N286', 'F290', 'G291', 'E292', 'N293', 'A294', 'D295', 'F297', 'F298', 'I299', 'F300',
            'P301', 'L321', 'Q1', 'R31', 'S32', 'T33', 'Y34', 'Y55', 'R58', 'W101', 'N102', 'Y103', 'F104', 'F105', 'Y109', 'Y50', 'R51', 'P56', 'S57']
pdb_1NCA = ['T30', 'N31', 'Y32', 'G33', 'W50', 'N52', 'T52A', 'N53', 'T54', 'E56', 'E61', 'K64', 'E96', 'D97', 'N98', 'F99', 'S100A', 'L100B', 'D101', 'T31', 'Y49', 'W50', 'S52', 'T53', 'R54', 'H55', 'I56', 'H91', 'Y92', 'S93', 'P94',
            'W96', 'I149', 'P326', 'R327', 'P328', 'N329', 'D330', 'G343', 'N344', 'N345', 'N347', 'I366', 'S367', 'I368', 'A369', 'S370', 'S372', 'T396', 'L399', 'N400', 'T401', 'D402', 'W403', 'P431', 'K432', 'E433', 'D434', 'K435', 'K463', 'E465']
pdb_2NZ9 = ['S902', 'K903', 'F917', 'N918', 'L919', 'E920', 'S921', 'P950', 'F953', 'N954', 'S955', 'I956', 'K1056', 'L1057', 'D1058', 'G1059', 'C1060', 'R1061', 'D1062', 'T1063', 'H1064', 'R1065', 'Y1066', 'T1145', 'D1289', 'G1292',
            'E1293', 'R1294', 'E27', 'S28', 'D30', 'S31', 'Y32', 'G33', 'H34', 'S35', 'F36', 'G70', 'S71', 'G95', 'N96', 'E97', 'V98', 'F100', 'S30', 'D31', 'Y33', 'Y35', 'T50', 'S52', 'D53', 'G54', 'S56', 'Y57', 'T58', 'Y59', 'Y99', 'Y101', 'D102']

pdb_dict = {
    "1BJ1": pdb_1BJ1,
    "1NMB": pdb_1NMB,
    "3BDY": pdb_3BDY,
    "1C08": pdb_1C08,
    "1VFB": pdb_1VFB,
    "3BE1": pdb_3BE1,
    "1CZ8": pdb_1CZ8,
    "1XGP": pdb_1XGP,
    "3BN9": pdb_3BN9,
    "1DQJ": pdb_1DQJ,
    "1XGQ": pdb_1XGQ,
    "3G6D": pdb_3G6D,
    "1DVF": pdb_1DVF,
    "1XGR": pdb_1XGR,
    "3GBN": pdb_3GBN,
    "1JRH": pdb_1JRH,
    "1XGT": pdb_1XGT,
    "3HFM": pdb_3HFM,
    "1KIP": pdb_1KIP,
    "1XGU": pdb_1XGU,
    "3L5X": pdb_3L5X,
    "1KIQ": pdb_1KIQ,
    "1YY9": pdb_1YY9,
    "3N85": pdb_3N85,
    "1KIR": pdb_1KIR,
    "2B2X": pdb_2B2X,
    "3NGB": pdb_3NGB,
    "1MHP": pdb_1MHP,
    "2BDN": pdb_2BDN,
    "3SE8": pdb_3SE8,
    "1MLC": pdb_1MLC,
    "2NY7": pdb_2NY7,
    "4FQY": pdb_4FQY,
    "1N8Z": pdb_1N8Z,
    "2NYY": pdb_2NYY,
    "5C6T": pdb_5C6T,
    "1NCA": pdb_1NCA,
    "2NZ9": pdb_2NZ9
}

data.reindex()

interfaces = []

for index, row in data.iterrows():
    mutations = re.split(";", row["Mutations"])
    for mutation in mutations:
        mutation = re.sub(r"\w:(\w\d+)\w", r"\1", mutation)
        is_interface = mutation in pdb_dict[row["#PDB"]]
        if is_interface:
            break
    interfaces.append(is_interface)

data["Interface?"] = interfaces
print(len(data[data["Interface?"] == True]))

try:
    data.to_csv('./raw_datasets/interface_data_use.csv', index=False)
    print("Wrote file.")
except:
    print("Did not output.")
